[["index.html", "Handling, Measuring, Estimating and Visualizing Migration Data in R Chapter 1 Introduction", " Handling, Measuring, Estimating and Visualizing Migration Data in R Guy J. Abel, James Raymer, Ellen Kraly 2023-05-22 Chapter 1 Introduction In many countries and regions throughout the world, human migration represents a major force of demographic, social and economic change. However, the underlying processes of migration are complex and data on the movements are often considered to be poor quality or limited in detail. Ideed, in many situations, migration data are completely missing or unusable for examining the patterns and consequences of interest. This is especially true for international migration. As a result, methods to estimate migration flows have been developed by demographers and other researchers to address shortfalls in data provision so that one can study the patterns, trends and consequences. This manual covers a range of methods for handling, measuring, estimating, and visualizing migration data in R. These methods are based on several authoritative sources, including the UN DESA manuals on Methods of measuring internal migration and Preparing migration data for subnational population projections, as well as the migration chapters of the IUSSP Tools for Demographic Estimation. Additionally, recent developments in the field are included. By the end, you will have a comprehensive understanding of the various methods available for working with migration data in R, and how to apply them to your own research. To make the most of this manual, we assume that you have basic knowledge of using R, especially the tidyverse set of packages. If you are not familiar with R or need a refresher, we recommend working your way through an online course before diving into this manual. Some good resources for learning R and the tidyverse include: R for Data Science, a comprehensive guide to data science in R, covering data import and cleaning, data visualization, and statistical modeling. DataCamp, an online learning platform that offers interactive courses on R programming and data science topics. R Bootcamp, a free online course that covers the basics of R programming and the tidyverse. Tidyverse.org, a website dedicated to the tidyverse packages with tutorials, articles, and other resources for learning and using them. Swirl, an interactive learning platform within R that teaches you how to use R in a hands-on manner. The above resources provide a comprehensive introduction to R programming and the tidyverse, which will be useful throughout this manual and in your future data analysis work. The manual is organized into nine chapters, each covering a different aspect of handling, measuring, estimating, and visualizing migration data in R. Chapter 1 provides an introduction to migration data and concepts. Chapter 2 focuses on handling migration data in R. Chapter 3 covers summary migration indices. Chapter 4 is dedicated to estimating net migration. Chapter 5 focuses on describing and estimating migration age structures. Chapter 6 covers methods for describing bilateral migration data. Chapter 7 covers methods for estimating bilateral migration. Finally, Chapters 8 and 9 cover methods for visualizing bilateral migration, including chord diagrams and Sankey plots. In each chapter, we provide code and data that will allow you to replicate the outputs we present, as well as exercises that allow you to practice the concepts and methods on your own. Solutions to these exercises are provided so you can check your work and ensure that you have a firm grasp of the material before moving on to the next chapter. By following the examples and completing the exercises in this manual, you will gain a deep understanding of how to handle, measure, estimate, and visualize migration data in R. "],["migration-concepts.html", "Chapter 2 Migration Concepts 2.1 Spatial 2.2 Temporal 2.3 Migration Measures 2.4 References", " Chapter 2 Migration Concepts Migration is a process that involves a change in the place of residence. There are two key dimensions that distinguish migration from other types of human movements and these are time (duration) and space (between places). That is, the process of migration involves moving to a place for an amount of time that is considered long and across a distance that is considered far – both aspects make the move significant and life changing. By life changing, we mean the person who has moved must alter they way they interact with the society they moved away from. In other words, migrations are movements that change the social circumstances of the individual. It an event that is distinguishable from other types of moves that are short duration (such as tourism or family visits) or short distance (residential mobility). Of course, both the duration and spatial dimensions of migration may be culturally defined, meaning that the processes of migration may differ between countries at a given spatial / time scale. In terms of practical measurement, the United Nations recommends that migration be linked to population change, where the place where one lives is defined as a place where the person ‘usually resides’ withing a given year. the measurement often excludes some groups, such as nomads, who do not have a fixed place of residence, or seasonal migrants, who live in two or more places during the course of a year. Further, migration is often measured as the crossing of a boundary (as opposed to a threshold of distance), whether it be an internal administrative bountry or an international border ((UnitedNations1983?)). Moreover, migration can be measured at various levels, including individuals and households, and domestic migration may be measured at different geographic scales depending on the types of administrative units that are available. Different individual / household groupings and spatial scales can have large invluences on the patterns we see. Thus, both spatial and temporal dimensions are required in the definition of migration. Moreover, unlike other demographic processes, migration is not a one-time event, but rather a process that can involve multiple moves over the course of a lifetime. 2.1 Spatial 2.1.1 Usual Residence Central to the spatial dimension of defining a migration event is the concept of place of residence, used to determine the migrants origin and destination locations. The Principles and Recommendations for Population and Housing Censuses (UN Statistics Division 2008: 102, para. 1.463) defines usual residence as follows: The place at which the person has lived continuously for most of the last 12 months (that is, for at least six months and one day), not including temporary absences for holidays or work assignments, or intends to live for at least six months The place at which the person has lived continuously for at least the last 12 months, not including temporary absences for holidays or work assignments, or intends to live for at least 12 months.” The use of two alternative criteria leaves some area of ambiguity, where the subtle differences in each could have significant implications for the measurement of migration. Further, within either of these criteria they might be additional ambiguity. For example, persons on long work assignments might have intentions to stay for only a few months that might turn into many months. When defining migration, restrictions on distance are often included ((Lee1966?)). In this situation, any move could be a migration including, for example, a move from one apartment to another in the same building or a move to another country. We advocate distinguishing between short disance / local moves, such as within cities or labor markets, and those that are considered longer distance (between cities or labor markets). We recognise that this distinction can be problematic given data availability and different contexts. However, we believe there are important distinctions to be made between local mobility and migration that make their separation worthwhile.Local mobility is primarily driven by household factors while migration is driven by economic and social network factors. Note, the methods covered in this manual can be used to analyse and estimate both types of movements. When analyzing migration patterns, it is useful to have information on the distance involved in a relocation. If address information on points of origin and destination is available, it is possible to tabulate moves by the distance covered. However, in many countries without population registers, this is not possible, and it may be time-consuming and of little policy relevance. Instead, administrative or political units into which the country is divided are often used. Therefore, migration is operationally defined as a change of residence from one civil division to another, and the volume of migration is then function of the size of areas chosen for compilation, where typically larger administrative units, such as a state or country, have a higher volume of migration compared to smaller units like cities or counties. Most countries typically have hierarchies in their administrative units and provide some internal migration data to reflect one or more of these geographies. Using larger geographic units can result in a loss of detail and accuracy in migration data. For instance, if a state is used as the unit of compilation, it may not capture migration patterns between different cities within the state, which could be important for local policy-making. On the other hand, using smaller geographic units such as census tracts may result in too much detail, making it difficult to draw broader conclusions about migration trends at the regional or national level. 2.1.2 Migration Data Types There are two main sources of migration flow data and they, to a large extent, determine the type of migration that are analysed and used in demographic estimation and projections. The two main sources are administrative registers and census / survey questionnaires. Administrative registers measure migration events. They record when a person relocates in continuous time, much like administrative registers of births or deaths. Thus, the number of persons who have migrated within a year can be calculated as the sum of all recorded moves that occured in that year. Often there are no duration qualifications so potentially persons can have multiple or return moves within a given year. Censuses and surveys, on the other hand, typically have questions on place of usual residence that can be cross tabulated with questions on place(s) of residence at a previous time, usually one or five years prior to the census / survey. Cross tabulations between place of residence one or five years ago with place of current residence represent migrant transitions. With these data, we do not know the exact date of the move, only that a move has occurred between two points in time. We do not know whether the move occurred 10 months ago or one week ago. Other types of migration data are occasionally collected that do not involve the origin location of a migration, including the duration at residence, number of moves over a given interval, and country of citizenship. Lifetime migration data is another common type of migration data. Similar to migrant transition data described above, lifetime migration data is cross tabulation between current place of usual residence and place of birth. However, these data are not considered a type of flow data. Instead, they are considered migrant population stock data. With these data, we do not know a time or period when the person migrated, only that they have migrated at least once since birth. The migration data literature often distinguishes between stock and flow data. For international migration, stock data have been gathered and tabulated from most countries in the world by the United Nations and World Bank and are widely used to study the cumulative effects of international migration. 2.1.3 Migrant Transition Data Migrant transition data are typically collected in national censuses, which identify migrants by comparing their place of usual residence at the time of enumeration (\\(t\\)) with that at a specified earlier date (\\(t-n\\)). This type of data provides information on the movements of migrants over a given time period, which is usually either 1 year (e.g. UK) or 5 years (e.g. USA). In terms of limitations, migrant transition data fail to identify multiple and return moves, which can lead to an underestimation of the true level of migration. Additionally, migrants who are born or who die during the measurement period are not counted. For example, a baby born three years ago would not have a place of usual residence five years ago. Surveys may also be used to gather migration data but the sample size must be sufficent to capture what is usually a small proportion of the population making a residential transition. In any given year, the vast majority of the population do not migrate domestically, let alone internationally. In migrant transition data, a migrant is a person who has experienced one or more migrations during a period measured retrospectively. It is important to note that persons who moved during the measurement interval and subsequently died before its end should technically be counted as migrants and their moves as migrations. However, in practice, such cases are usually unknown or excluded, as the information is usually obtained at the end of the time interval and with reference to persons who are alive at that time. Similarly, with international migration, censuses can be used to measure immigrant transitions but not emigrant transitions. The reason is that the current place of residence is in country not gathering the census data. Censuses have been used to ask questions about family members who have emigrated but if the whole family migrated, then again, censuses would not capture them. 2.1.4 Migation Event Data Migration event data record all moves made by individual in an administrative system. These include multiple and return moves, newborn moves, and moves immediately before death. Ideally, moves come from a centralised population register, however, other registers that do not necessarily cover the whole population may be used. For instance, some countries require persons to register with local health clinics when moves are made, others may use tax file reports with updated address information as sources of moves. Other administrative registers include those are used for education or voting registrations. Outside population registers, it is important that the migration event data are linked to the usual residence population before analysis of patterns or use in demographic estimation models. While registers tend to provide a more complete record of migration over time, they may not include the whole population or there may be instances where people do not register or de-register. For example, a common problem with health registration data is young adults (especially males) only register when they see a doctor (which may be several years after the move) or they do not register and continue to visit the health clinic linked to their previous residential location if, say, their parents still live in that location or it is not too far away. Another issue is that geographical units used in administrative registers are generally coarser, and registers often fail to capture within-region moves. Additionally, administrative registers often do not include information about the characteristics of migrants outside age and sex. Some groups may be omitted altogether, such as prisoners and military personnel. 2.2 Temporal 2.2.1 Migration Interval Migration is a continuous process that occurs over time. To study the propensity or rate of migration, data must be compiled with reference to specific periods of time. These time periods can be either definite or indefinite. Definite interval data is typically collected over fixed-term periods such as one year, five years, ten years, or intercensal periods. Indefinate interval data such as lifetime migration measures or data based on place of last residence lack a definite time reference as age or time at the current residence varies by each individual migrant. The comparability of migration data with different definite time intervals can be prohibitively complicated. Commonly described as the one-year / five-year problem, observed migration data consistently shows the number of migrants recorded over a five-year interval is far less than five times the number recorded over a one-year interval. In addition, the ratio of migrants between a five-year period and a one-year period is not constant, where variations occur depending on multiple factors such as the intensity and type of migration both over time and in each origin and destination. Consequently, there is no straightforward algebraic solution to comparing one-year and five-year migration probabilities (Rogerson1990?). With international migration, each country measures migration differently and for their own purposes. Often, the rules of the administrative register determine the measure of migration. While the United Nations recommends measures that are aligned with changes in the country of usual residence, the reality is that countries may differ greatly, ranging from, say, no defined time period, three months, six months, or 12 months. Some countries with strong border control statistics are able to track all entries and exits. In Australia, an immigrant is someone who was previously living abroad and stays in the country for 12/16 months. Similarly, an emigrant is someone who has been outside Australia for 12/16 months. Some countries, especially in Eastern Europe, have population registers that rely on the notion of a ‘permanent’ residence, implying that persons leaving (entering) will never return (leave). Countries who use types of systems grossly undercount the true levels of migration. (Cite MIMOSA / IMEM papers) 2.3 Migration Measures Migration measures are used to quantify the magnitude and direction of population movements between places or regions. These measures can provide important insights into the demographic and social dynamics of populations. There are several different types of migration measures that are commonly used in research and policy analysis, each with its own strengths and limitations. One of the most common migration measures is the migration rate or intensity, which is defined as the number of migrants observed during a period of time divided by the mid-year population (or average population ‘at risk’ of migration). The migration rate can be calculated for different migration types discussed above, such as one year or five years, and can be used to compare migration across different places or regions. Note, a probability of migration is different from a rate in how the ‘at risk’ population is defined. In a rate, the population at risk is the mid-year (average) population, whereas in probability, the population at the beginning of the time interval is used as the population at risk. Other migration measures include the count of the number of migrants and the migrant proportion. The migrant proportion is share of the population population that migrated. These measures can be useful for identifying patterns in migration behavior, such as the prevalence of long-distance migration or the likelihood of migration among certain demographic groups. In demography, some analysts would argue that there is no such thing as a in-migration or immigration rate since the the population at risk is outside the population of interest. Rather they are simply ratios that compare the number of migrants to the size of the receiving population. This problem does occur for out-migration rates or emigration rates since both have clear populations at risk of migration. All migration measures can be affected by data quality, such as underreporting of migrants or errors in place of residence information. These problems tend to increase as the data become more detailed. Additionally, different measures may be more appropriate for different research questions or policy applications. For example, the migration rate may be more useful for understanding the overall magnitude of migration in the population, while the count of migrants can provide a basic understanding of the scale of migration patterns over time and between different spatial units. Migration measures can be defined at different levels of detail, ranging from region-to-region measures, to region totals, to system totals or index measures. Region-to-region measures capture the flow of migrants between two specific regions, while region totals capture the total number of migrants coming in or going out of a specific region. System totals, or index measures, provide an overall picture of migration within a given system or country, which we will discuss in more detail in the next chapter. 2.3.1 Region-to-region Region-to-region migration measures also known as bilateral migration, migration streams or origin-destination migration, refer to a migration measure that cross-classified by region of origin and region of destination, forming a matrix of \\(n \\times (n-1)\\) streams along each origin-destination combination, where \\(n\\) represents the number of regions. The set of region-to-region migration measures can be represented by \\(m_{ij}\\), where the sub-scripts \\(i\\) and \\(j\\) represent the same set of regions for each origin-destination combination. The set of bilateral migration flows provide a basis to asses the compartive volumnes and directions of migration between a set of regions. The gross interchange represents the total number of migrants moving between a particular pair of regions, i.e. \\(m_{ij} + m_{ji}\\). The net migration steam or bilateral net migration represents the difference in migration between a pair of region i.e. \\(m_{ij} - m_{ji}\\). For a pair of streams that are of unequal size, where the net migration stream is not close to zero, there exists a dominant stream which is far large than the reverse or counter stream in the opposite direction. 2.3.2 Region Totals Every migration event can be considered an out-migration in relation to the region of origin and an in-migration in relation to the region of destination. When migration events involve changes of countries, migration events are typically described as emigration and immigration, rather than out-migration and in-migration. Totals on in- or out-migration for each region are typically used to evaluate the volume of migration to or from a particular set of regions. In some countries, data is collected or aggregated without reference to the place of origin for in-migration totals or destination for out-migration totals. Consequently the migration totals provide the most detailed measure of regional migration but with little information on the direction of the migration flows between each region. A summary of the common terms for migration totals are shown in Table 1. The in-migration (or immigration) totals can be represented by replacing the origin \\(i\\) index with a \\(+\\); \\(m_{+j}\\). Similarly, the out-migration (or emigration) totals can be represented by replacing the destination \\(j\\) index with \\(+\\); \\(m_{+j}\\). Scale Area Event Term Migrant Term Internal Origin out-migration out-migrant Destination in-migration in-migrant International Origin emigration emigrant Destination immigration immigrant The sum of the in-migration and out-migration totals (\\(m_{i+} + m_{+j}\\)) provides the turnover of each region. Net migration totals provides a balance of movements in opposing directions from the difference between in-migration and out-migration (\\(m_{+j} - m_{i+}\\)). Net migration measures are more typically obtained via demographic accounting, as a residual from the differences in population change, births and deaths over a period in each region. As this calculation does not require expensive migration data collection systems, net migration measures are one of the most common forms of migration measures. However, net migration measures have a number of notable drawbacks, as highlighted by (rogers1990rnm?). In particular, net migration does not enumerate migrants themselves, but instead follows a residual of in-migrants and out-migrants. Consequently, the dynamics related to the observed migration patterns can be missed. For example, an net migration of -100 might involve a region receiving no in-migrants and sending 100 out-migrants or receiving 1,000,000 migrants and sending 1,000,100 out-migrants. Further migration dynamics are also missed when looking at net migration rates (discussed in the next section) and regularities in age profiles of migration (discussed in Chapter X) are often preculded when using age-specicifc net migration measures. 2.3.3 Rate measures Migration rates are important indicators for understanding the dynamics of population movement. Out-migration or emigration rates are calculated by dividing the number of out-migrants or emigrants during a specific period by the population exposed to the likelihood of migration. This is represented by the formula: \\[ e^{[t, t+1]} = \\frac{E^{[t, t+1]}}{P}k \\] Here, \\(e^{[t, t+1]}\\) represents the out or emigration rate, \\(E\\) is the number of out-migrants or emigrants during the period, \\(P\\) is the population exposed to the likelihood of migration, and \\(k\\) is a constant, often set as 1000. The exposure population can be the population at the mid-interval, assuming migration is evenly distributed, or the population at the start or end of the interval if migration has a negligible effect on population change. Additionally, out-migration rates can be further decomposed by subsets of the population, such as age or sex: \\[ e^{[t, t+1]}_i = \\frac{E^{[t, t+1]}_i}{P_i}k \\] On the other hand, in-migration or immigration ratios are calculated by dividing the number of in-migrants or immigrants by the population not exposed to the risk of migrating into the region. The formula for in-migration ratio is: \\[ i^{[t, t+1]} = \\frac{I^{[t, t+1]}}{P}k \\] Similarly, net migration ratios are calculated by dividing the net migration (difference between in-migration and out-migration) by the population not exposed to migration risk: \\[ m^{[t, t+1]} = \\frac{M^{[t, t+1]}}{P}k \\] As mentioned previously, in-migration and net migration ratios are different from demographic rates because they use the resident population in the denominator. This approach satisfies the needs of the demographic balancing equation, as rates of gain and loss are measured relative to the same population. The demographic balancing equation is expressed as: \\[ P^{t+1} = P^t \\left(1 + b^{[t, t+1]} - d^{[t, t+1]} + i^{[t, t+1]} - e^{[t, t+1]} \\right) \\] where \\(P^{t+1}\\) is the population at the next time point, \\(b^{[t, t+1]}\\) and \\(d^{[t, t+1]}\\) represent births and deaths during the period, and \\(i^{[t, t+1]}\\) and \\(e^{[t, t+1]}\\) denote in-migration and out-migration rates. Net migration (\\(M^{[t, t+1]}\\)) can be substituted with the difference between in-migration and out-migration (\\(I^{[t, t+1]} - O^{[t, t+1]}\\)). The equation can be simplified as: \\[ P^{t+1} = P^t \\left(1 + b^{[t, t+1]} - d^{[t, t+1]} + i^{[t, t+1]} - o^{[t, t+1]} \\right) \\] This formulation allows for the analysis of population change considering the effects of births, deaths, in-migration, and out-migration. 2.4 References "],["handling-migration-data-in-r.html", "Chapter 3 Handling Migration Data in R 3.1 Contingency Table 3.2 Data Creation 3.3 Data Manipulation 3.4 Matrix Operations 3.5 Summaries", " Chapter 3 Handling Migration Data in R The R statistical language provides many powerful tools to carry out data analysis. In this chapter we highlight some useful R functions to manipulate migration data into specific formats that might be required for more advanced functions to analysis or visualization. 3.1 Contingency Table Bilateral migration data are often organized and represented in square tables, commonly referred to as migration matrices or migration flow tables. These tables are contingency tables, otherwise know as cross-tabulations or frequency tables, used in data analysis and statistics. Migration flow tables provide a structured way to organize and summarize origin-destination migration data, with rows representing the regions of origin and columns representing the regions of destinations. The cells in the table capture the number of persons migrating from one region to another. The inspection of migration tables themselves provide valuable insights into the magnitudes and directions of migration between different regions. Origin Destination A B C D Sum A 100 30 70 200 B 50 45 5 100 C 60 35 40 135 D 20 25 20 65 Sum 130 160 95 115 500 The diagonal cells in migration flow tables represent populations that either do not migrate (remain) or make moves within the same region. These values are useful to provide a relative sense of migration in relation to local mobility or to the population not migrating. Alternatively, one can place zeros in the diagonal elements (or nothing as in the table above) so that the table only consists of those migrating between regions. 3.2 Data Creation In R, migration flow tables can be created directly using the matrix() or array() functions. Both functions create array type objects. They are sometimes a pre-requisite for more complicated functions used for describing, estimating or visualising bilateral migration data. The matrix() function allows users to specify the dimensions of the matrix and populate it with desired values. It can be used to create matrices of any size, and supports various options for filling in the matrix, such as using a sequence of numbers, replicating values, or using auxiliary data sources. Data is provided via a vector passed to the data argument. By default the data populates the matrix from the first column on, which can be altered by setting byrow = FALSE. m0 &lt;- matrix(data = c(0, 100, 30, 70, 50, 0, 45, 5, 60, 35, 0, 40, 20, 25, 20, 0), nrow = 4, ncol = 4, byrow = TRUE) m0 ## [,1] [,2] [,3] [,4] ## [1,] 0 100 30 70 ## [2,] 50 0 45 5 ## [3,] 60 35 0 40 ## [4,] 20 25 20 0 It is often valuable to supply a vector of character strings for the origin and destination names to the matrix data object. These can be linked to an existing matrix object using the dimnames() via the dimnames argument. The corresponding rownames() and colnames() functions can be used to assign or display individual dimension names. # create region labels r &lt;- LETTERS[1:4] r ## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; # check dimension names dimnames(m0) ## NULL # add dimension names dimnames(m0) &lt;- list(orig = r, dest = r) m0 ## dest ## orig A B C D ## A 0 100 30 70 ## B 50 0 45 5 ## C 60 35 0 40 ## D 20 25 20 0 # create matrix with dimension names directly # m0 &lt;- matrix(data = c(0, 100, 30, 70, 50, 0, 45, 5, 60, 35, 0, 40, 20, 25, 20, 0), # nrow = 4, ncol = 4, byrow = TRUE, # dimnames = list(orig = r, dest = r)) In R, the array() function is used to create multidimensional arrays, which can have more than two dimensions. While the matrix() function creates two-dimensional structures. Similar to the matrix() function, the array() function allows users to define the dimensions of the array and populate it with desired values. However, in the array() function, the dimensions are specified as a vector to the dim argument, indicating the size of each dimension. The array() function can be seen as a generalization of the matrix() function, as matrices are a specific type of two-dimensional arrays. By using the array() function, users can work with data that requires more complex organization and analysis, such as migration flows cross classified by origin, destination and additional variables such as sex, age or education. m1 &lt;- array(data = sample(x = 1:100, size = 32), dim = c(4, 4, 2), dimnames = list(orig = r, dest = r, sex = c(&quot;female&quot;, &quot;male&quot;))) m1 ## , , sex = female ## ## dest ## orig A B C D ## A 56 61 46 45 ## B 14 78 50 36 ## C 27 32 53 57 ## D 10 59 44 68 ## ## , , sex = male ## ## dest ## orig A B C D ## A 60 55 40 35 ## B 82 5 29 66 ## C 28 25 3 92 ## D 63 26 9 2 3.3 Data Manipulation Statistical offices, government agencies, and international organizations collect and disseminate migration data in different formats to accommodate the needs of users and researchers. The format of the data may not necessarily be in square matrices that can be read directly into R and converted into a matrix object. However, there are useful functions in R that can be employed to convert data into appropriate formats for migration analysis. The xtabs() function is particularly helpful as it enables the conversion of data frames in a tidy format (Wickham2014?) into matrices or arrays. It requires a formula argument that specifies the column names in the data frame that will be used to construct and populate the matrix or array. The formula consists of the left-hand side representing the column name with the data to fill, the ~ symbol to separate the left and right-hand sides, and the right-hand side representing the columns used for cross-classifying the left-hand variable (separated by +). The data argument specifies the object where the data presented in a tidy format with variables included in the formula. ## # A tibble: 16 × 3 ## orig dest flow ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 A A 1 ## 2 A B 2 ## 3 A C 3 ## 4 A D 4 ## 5 B A 5 ## 6 B B 6 ## 7 B C 7 ## 8 B D 8 ## 9 C A 9 ## 10 C B 10 ## 11 C C 11 ## 12 C D 12 ## 13 D A 13 ## 14 D B 14 ## 15 D C 15 ## 16 D D 16 ## dest ## orig A B C D ## A 1 2 3 4 ## B 5 6 7 8 ## C 9 10 11 12 ## D 13 14 15 16 The as.data.frame.table() function provides an inverse of the data manipulation of the xtabs() function, whereby it takes a matrix or array and converts it into a data frame based on the array dimension names. The responseName argument can be used to set the column name of the values in the cells of the matrix or array. # convert previous matrix back to tibble m2 %&gt;% as.data.frame.table(responseName = &quot;migration&quot;) %&gt;% as_tibble() ## # A tibble: 16 × 3 ## orig dest migration ## &lt;fct&gt; &lt;fct&gt; &lt;int&gt; ## 1 A A 1 ## 2 B A 5 ## 3 C A 9 ## 4 D A 13 ## 5 A B 2 ## 6 B B 6 ## 7 C B 10 ## 8 D B 14 ## 9 A C 3 ## 10 B C 7 ## 11 C C 11 ## 12 D C 15 ## 13 A D 4 ## 14 B D 8 ## 15 C D 12 ## 16 D D 16 Note, above we use as_tibble() to convert the data.frame object returned from as.data.frame.table() to the more user friendly tibble object type (insert citation) and use the pipe line function %&gt;% to combine together a sequence of R functions. # convert array to tibble d1 &lt;- m1 %&gt;% as.data.frame.table(responseName = &quot;flow&quot;) %&gt;% as_tibble() d1 ## # A tibble: 32 × 4 ## orig dest sex flow ## &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; ## 1 A A female 56 ## 2 B A female 14 ## 3 C A female 27 ## 4 D A female 10 ## 5 A B female 61 ## 6 B B female 78 ## 7 C B female 32 ## 8 D B female 59 ## 9 A C female 46 ## 10 B C female 50 ## # … with 22 more rows 3.4 Matrix Operations When working with matrix objects based on migration data in R there are additional functions that are useful for further formatting and data exploration. The addmargins() function is a useful tool for adding row and column margin totals to a matrix or array object. addmargins(A = m0) ## dest ## orig A B C D Sum ## A 0 100 30 70 200 ## B 50 0 45 5 100 ## C 60 35 0 40 135 ## D 20 25 20 0 65 ## Sum 130 160 95 115 500 When working with migration matrices in R, it can sometimes be challenging to effectively view and analyze the data due to various factors such as lengthy dimension names and large unit sizes. Additionally, the inclusion of diagonal terms, which are often not of interest in migration analysis, can further complicate the interpretation of the matrix. R provides several helpful functions that can assist in adapting migration matrix objects for easier viewing and analysis. To illustrate, we use the uar_1960 object from the migest package, which represents a lifetime migration matrix for the Governorates of the United Arab Republic in 1960 as documented in the United Nations manual by (UnitedNations1983?). Notice how the object is difficult to view due to issues described above: library(migest) uar_1960 ## dest ## orig Cairo Alexandria Port-Said Ismailia Kalyubia Gharbia Menoufia ## Cairo 2079434 31049 5293 9813 23837 10034 7038 ## Alexandria 47220 1085602 2641 2625 2135 4921 1505 ## Port-Said 9464 2562 168046 6461 496 817 323 ## Ismailia 9518 1395 3490 171297 718 910 306 ## Kalyubia 90668 4730 758 3182 886464 3727 3523 ## Gharbia 99179 39953 1742 3347 7870 1604851 6313 ## Menoufia 216764 46781 1640 3338 2918 29580 1308283 ## Giza 64584 4899 513 2013 2887 1503 2161 ## Assyiut 100305 25497 1738 2522 122 2245 636 ## Souhag 100100 63712 12087 9436 295 2791 1095 ## All others 456464 177476 43898 66973 49816 47315 12179 ## dest ## orig Giza Assyiut Souhag All others ## Cairo 88543 4951 2569 58476 ## Alexandria 6910 1355 1467 29534 ## Port-Said 1505 326 454 11184 ## Ismailia 1593 319 263 10269 ## Kalyubia 10279 340 128 18076 ## Gharbia 14529 848 491 64140 ## Menoufia 30915 567 401 47843 ## Giza 1040179 540 433 13518 ## Assyiut 13153 1290255 5955 35157 ## Souhag 17958 11608 1540020 53224 ## All others 94577 14690 22375 11900302 When working with names or labels that are lengthy or contain unnecessary details, the abbreviate() function can be helpful. The function applies an algorithm to shorten the names while still retaining their essential information. dimnames(uar_1960) ## $orig ## [1] &quot;Cairo&quot; &quot;Alexandria&quot; &quot;Port-Said&quot; &quot;Ismailia&quot; &quot;Kalyubia&quot; ## [6] &quot;Gharbia&quot; &quot;Menoufia&quot; &quot;Giza&quot; &quot;Assyiut&quot; &quot;Souhag&quot; ## [11] &quot;All others&quot; ## ## $dest ## [1] &quot;Cairo&quot; &quot;Alexandria&quot; &quot;Port-Said&quot; &quot;Ismailia&quot; &quot;Kalyubia&quot; ## [6] &quot;Gharbia&quot; &quot;Menoufia&quot; &quot;Giza&quot; &quot;Assyiut&quot; &quot;Souhag&quot; ## [11] &quot;All others&quot; # make a copy u0 &lt;- uar_1960 # new abbreviated region names r &lt;- list(orig = uar_1960 %&gt;% rownames() %&gt;% abbreviate(), dest = uar_1960 %&gt;% colnames() %&gt;% abbreviate()) r ## $orig ## Cairo Alexandria Port-Said Ismailia Kalyubia Gharbia Menoufia ## &quot;Cair&quot; &quot;Alxn&quot; &quot;Pr-S&quot; &quot;Isml&quot; &quot;Klyb&quot; &quot;Ghrb&quot; &quot;Menf&quot; ## Giza Assyiut Souhag All others ## &quot;Giza&quot; &quot;Assy&quot; &quot;Sohg&quot; &quot;Allo&quot; ## ## $dest ## Cairo Alexandria Port-Said Ismailia Kalyubia Gharbia Menoufia ## &quot;Cair&quot; &quot;Alxn&quot; &quot;Pr-S&quot; &quot;Isml&quot; &quot;Klyb&quot; &quot;Ghrb&quot; &quot;Menf&quot; ## Giza Assyiut Souhag All others ## &quot;Giza&quot; &quot;Assy&quot; &quot;Sohg&quot; &quot;Allo&quot; # apply the abbreviated region names dimnames(u0) &lt;- r u0 ## dest ## orig Cair Alxn Pr-S Isml Klyb Ghrb Menf Giza Assy ## Cair 2079434 31049 5293 9813 23837 10034 7038 88543 4951 ## Alxn 47220 1085602 2641 2625 2135 4921 1505 6910 1355 ## Pr-S 9464 2562 168046 6461 496 817 323 1505 326 ## Isml 9518 1395 3490 171297 718 910 306 1593 319 ## Klyb 90668 4730 758 3182 886464 3727 3523 10279 340 ## Ghrb 99179 39953 1742 3347 7870 1604851 6313 14529 848 ## Menf 216764 46781 1640 3338 2918 29580 1308283 30915 567 ## Giza 64584 4899 513 2013 2887 1503 2161 1040179 540 ## Assy 100305 25497 1738 2522 122 2245 636 13153 1290255 ## Sohg 100100 63712 12087 9436 295 2791 1095 17958 11608 ## Allo 456464 177476 43898 66973 49816 47315 12179 94577 14690 ## dest ## orig Sohg Allo ## Cair 2569 58476 ## Alxn 1467 29534 ## Pr-S 454 11184 ## Isml 263 10269 ## Klyb 128 18076 ## Ghrb 491 64140 ## Menf 401 47843 ## Giza 433 13518 ## Assy 5955 35157 ## Sohg 1540020 53224 ## Allo 22375 11900302 Basic arithmetic operators can be employed to scale the data to an appropriate level, such as dividing the values by a common factor or multiplying them to achieve a desired magnitude. This can be useful when working with migration matrices to adjust the values and make them more interpretable or comparable. The round() function which allows users to specify the precision of numbers in your migration data, which can be handy when working with migration rates or proportions. u1 &lt;- round(x = u0/1000, digits = 1) u1 ## dest ## orig Cair Alxn Pr-S Isml Klyb Ghrb Menf Giza Assy Sohg ## Cair 2079.4 31.0 5.3 9.8 23.8 10.0 7.0 88.5 5.0 2.6 ## Alxn 47.2 1085.6 2.6 2.6 2.1 4.9 1.5 6.9 1.4 1.5 ## Pr-S 9.5 2.6 168.0 6.5 0.5 0.8 0.3 1.5 0.3 0.5 ## Isml 9.5 1.4 3.5 171.3 0.7 0.9 0.3 1.6 0.3 0.3 ## Klyb 90.7 4.7 0.8 3.2 886.5 3.7 3.5 10.3 0.3 0.1 ## Ghrb 99.2 40.0 1.7 3.3 7.9 1604.9 6.3 14.5 0.8 0.5 ## Menf 216.8 46.8 1.6 3.3 2.9 29.6 1308.3 30.9 0.6 0.4 ## Giza 64.6 4.9 0.5 2.0 2.9 1.5 2.2 1040.2 0.5 0.4 ## Assy 100.3 25.5 1.7 2.5 0.1 2.2 0.6 13.2 1290.3 6.0 ## Sohg 100.1 63.7 12.1 9.4 0.3 2.8 1.1 18.0 11.6 1540.0 ## Allo 456.5 177.5 43.9 67.0 49.8 47.3 12.2 94.6 14.7 22.4 ## dest ## orig Allo ## Cair 58.5 ## Alxn 29.5 ## Pr-S 11.2 ## Isml 10.3 ## Klyb 18.1 ## Ghrb 64.1 ## Menf 47.8 ## Giza 13.5 ## Assy 35.2 ## Sohg 53.2 ## Allo 11900.3 The diag() function allows users to manipulate the diagonal terms of a matrix, which can be much larger than the number of persons migrating in the non-diagonal cells. The diag() function takes a matrix as input and returns a new matrix with the same values, except that the diagonal elements are modified according to the specified rule. In the context of migration data, setting the diagonal terms to zero effectively removes the non-moving populations from the matrix, making it easier to analyze the migration flows. u2 &lt;- u0 diag(u2) &lt;- 0 u2 ## dest ## orig Cair Alxn Pr-S Isml Klyb Ghrb Menf Giza Assy Sohg Allo ## Cair 0 31049 5293 9813 23837 10034 7038 88543 4951 2569 58476 ## Alxn 47220 0 2641 2625 2135 4921 1505 6910 1355 1467 29534 ## Pr-S 9464 2562 0 6461 496 817 323 1505 326 454 11184 ## Isml 9518 1395 3490 0 718 910 306 1593 319 263 10269 ## Klyb 90668 4730 758 3182 0 3727 3523 10279 340 128 18076 ## Ghrb 99179 39953 1742 3347 7870 0 6313 14529 848 491 64140 ## Menf 216764 46781 1640 3338 2918 29580 0 30915 567 401 47843 ## Giza 64584 4899 513 2013 2887 1503 2161 0 540 433 13518 ## Assy 100305 25497 1738 2522 122 2245 636 13153 0 5955 35157 ## Sohg 100100 63712 12087 9436 295 2791 1095 17958 11608 0 53224 ## Allo 456464 177476 43898 66973 49816 47315 12179 94577 14690 22375 0 3.5 Summaries 3.5.1 Bilateral measures the migest package offers several useful functions for generating summaries of origin-destination migration data. One such function is sum_bilat(), which allows you to calculate the counter flow, net flow and interchange for all migration pairs. This function can accept either a matrix, array or a data.frame (or tibble) as input. sum_bilat(m0) ## # A tibble: 12 × 8 ## orig dest corridor pair flow counter_flow net_flow interchange ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 B A B -&gt; A A - B 50 100 -50 150 ## 2 C A C -&gt; A A - C 60 30 30 90 ## 3 D A D -&gt; A A - D 20 70 -50 90 ## 4 A B A -&gt; B A - B 100 50 50 150 ## 5 C B C -&gt; B B - C 35 45 -10 80 ## 6 D B D -&gt; B B - D 25 5 20 30 ## 7 A C A -&gt; C A - C 30 60 -30 90 ## 8 B C B -&gt; C B - C 45 35 10 80 ## 9 D C D -&gt; C C - D 20 40 -20 60 ## 10 A D A -&gt; D A - D 70 20 50 90 ## 11 B D B -&gt; D B - D 5 25 -20 30 ## 12 C D C -&gt; D C - D 40 20 20 60 3.5.2 Total Measures Another useful function in the migest package is sum_region(), which allows you to generate comprehensive summaries of in-migration, out-migration, net migration, and turnover totals for each region in your migration data. Similar to the sum_bilat() function, sum_region() also accepts either a matrix or a data.frame (or tibble) as input, providing flexibility in working with different data formats. By using the sum_region() function, you can obtain valuable information about migration flows at the regional level. It calculates the total number of migrants moving into each region (in-migration), the total number of migrants moving out of each region (out-migration), the net migration balance (in-migration minus out-migration), and the turnover (sum of in-migration and out-migration) for each region. These summaries are useful for further analyses and interpretations. sum_region(m0) ## # A tibble: 4 × 5 ## region out_mig in_mig turn net ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 A 200 130 330 -70 ## 2 B 100 160 260 60 ## 3 C 135 95 230 -40 ## 4 D 65 115 180 50 Note, when the data provided to the sum_region() is a data frame, the origin and destination regions names are assumed to be in variables named orig and dest. In addition, the migration data are assumed to be in variable named flow. If the corresponding column names differ, the user can supply these to the orig_col, dest_col and flow_col argumenets in the sum_region() function. The sum_country() function provides the same calculations, along with summary variables names. When the input data for either the sum_region() or sum_country() functions represent more than two dimensions, the group_by function from the dplyr package should be used. To demonstrate, we use the international flow estimates of (Abel2019?) which can be downloaded and read directly into R from the online CSV file. # read data from web depository f &lt;- read_csv(&quot;https://ndownloader.figshare.com/files/26239945&quot;) f ## # A tibble: 235,236 × 9 ## year0 orig dest sd_drop_neg sd_rev_neg mig_rate da_min_open da_mi…¹ da_pb…² ## &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1990 BDI BDI 0 0 0 0 0 0 ## 2 1990 COM BDI 0 0 0 0 0 0 ## 3 1990 DJI BDI 0 0 0 0 0 0 ## 4 1990 ERI BDI 0 0 0 0 0 90 ## 5 1990 ETH BDI 0 0 0 0 0 2 ## 6 1990 KEN BDI 30 30 69 45 29 87 ## 7 1990 MDG BDI 0 0 0 0 0 0 ## 8 1990 MWI BDI 0 0 0 0 0 125 ## 9 1990 MUS BDI 0 0 0 0 1 1 ## 10 1990 MYT BDI 0 0 0 0 0 0 ## # … with 235,226 more rows, and abbreviated variable names ¹​da_min_closed, ## # ²​da_pb_closed # single period (1990-1995) f %&gt;% filter(year0 == 1990) %&gt;% sum_country(flow_col = &quot;da_pb_closed&quot;) ## # A tibble: 197 × 5 ## country emi imm turn net ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ABW 1662 15874 17536 14212 ## 2 AFG 345255 3421712 3766967 3076457 ## 3 AGO 82775 225637 308412 142862 ## 4 ALB 464693 21479 486172 -443214 ## 5 ARE 272648 640784 913432 368136 ## 6 ARG 444239 339393 783632 -104846 ## 7 ARM 648202 151937 800139 -496265 ## 8 ATG 6153 8387 14540 2234 ## 9 AUS 691618 1042781 1734399 351163 ## 10 AUT 154853 382724 537577 227871 ## # … with 187 more rows # all periods using group_by f %&gt;% group_by(year0) %&gt;% sum_country(flow_col = &quot;da_pb_closed&quot;) %&gt;% arrange(country) ## # A tibble: 1,188 × 6 ## # Groups: year0 [6] ## year0 country emi imm turn net ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1990 ABW 1662 15874 17536 14212 ## 2 1995 ABW 4007 10945 14952 6938 ## 3 2000 ABW 3814 10064 13878 6250 ## 4 2005 ABW 7544 7124 14668 -420 ## 5 2010 ABW 8654 9910 18564 1256 ## 6 2015 ABW 16306 17316 33622 1010 ## 7 1990 AFG 345255 3421712 3766967 3076457 ## 8 1995 AFG 1286436 418906 1705342 -867530 ## 9 2000 AFG 434706 1178865 1613571 744159 ## 10 2005 AFG 1500149 457339 1957488 -1042810 ## # … with 1,178 more rows "],["summary-migration-indices.html", "Chapter 4 Summary Migration Indices 4.1 Migration intensity 4.2 Migration distance 4.3 Migration connectivity 4.4 Migration impact 4.5 Applying index functions multiple times", " Chapter 4 Summary Migration Indices Migration analysis, particularly regarding cross national comparisons of migration, has received relatively far less attention compared to studies on other the other demographic components of population change. This disparity is partly due to the complexity involved in comparing migration data and patterns across nations, regions and over time. Several factors contribute to the intricacy of such comparisons: Diverse Definitions of Migration: Nations may employ different definitions of migration, which might alter over time, making it challenging to establish consistent criteria for measuring and comparing migration accurately. Variations in Data Collection Systems: The methods and systems used for collecting migration data can differ among countries, further complicating comparisons. Discrepancies in data collection practices can affect the quality, coverage, and reliability of migration statistics. Heterogeneous Regional Sizes: Spatial units, such as regions or administrative divisions, vary in size across countries. This variation in regional scales can influence the interpretation and analysis of migration patterns, as migration rates may be influenced by the size of the areas being studied. Changing Number of Regions: The number of regions within a country may change over time due to administrative or political reforms. Such changes can disrupt the continuity and consistency of migration data, making it challenging to track migration trends accurately. Diverse Approaches to Distance Measurement: Different regions or countries may adopt varying methods to measure distances between locations. These differences can impact migration analyses that rely on distance-based measures, such as gravity model analyses. Fluctuations in Population Sizes and Structures: The underlying population sizes and demographic structures of regions or countries can change over time. These changes can influence migration patterns and introduce additional complexities when comparing migration data across different time periods or geographic areas. Given these factors, it is important to consider the contextual nuances and data issues when conducting cross-national or temporal comparisons of migration. In recent decades a growing number of summary migration measures and indices have been proposed to attempt to address one or more of the factors above. (Bell2002?) brought together many of these measure and extended others to help facilitate the improved comparisons of internal migration across nations. These measures were incorporated into the IMAGE software, to build comparisons of internal migration patterns in multiple countries (Bell2015?), (Bell2015a?), (Stillwell2016?), (Rees2016?), and (Bernard2014?). In the work of (Bell2002?), four main groups of migration indices were identified, providing a comprehensive framework for understanding and analyzing migration patterns. These groups include intensity of migration, distance of migration, migration connectivity, and the effect of migration on the redistribution of populations. In the remainder of this chapter we concentrate on available functions in R that can be used to calculate a range of summary migration indices in these four groups, and show how they can be applied to study changes in migration patterns over time or between countries. 4.1 Migration intensity Migration intensity measures focus on capturing the overall level or incidence of mobility within a population. These measures aim to provide a single indicator that allows for comparisons of migration intensities over different time periods or geographical areas. They help researchers understand the relative magnitude of migration flows and sets of regions or periods with higher or lower levels of migration activity. There are a number of age-specific migration intensity measures, that summarise how migration varies across different age groups. We will leave our discussion on these age-specific migration measures to the subsequent chapter on age schedules, where we introduce related migration age schedules that are used in the calculation of some summary indicies. Crude migration intensity is a straightforward measure that provides an indication of the overall propensity to migrate within a population, similar to how crude birth or death rates reflect the overall incidence of births or deaths. When migration transition data is available, the crude migration probability (CMP) can be calculated to estimate the likelihood of migration over the total population; \\[ \\texttt{CMP} = 100 M/P \\] The CMP is calculated by dividing the total number of migrants (\\(M\\)) in a specific time period by the population at risk (\\(P\\)) during that same period. The result is then multiplied by 100 to express it as a percentage. In the study by Courgeau (1973), the relationship between the intensity of migration and the number of regions in a country was examined. It was proposed that the crude migration probability (CMP) can be expressed as a function of the number of regions, denoted as ‘n’, and a constant ‘k’. \\[ \\texttt{CMP} = k \\log (n^2) \\] The value of \\(k\\) in Courgeau’s formula does not have an intrinsic meaning by itself. However, it serves as a scaling factor that allows for comparisons of migration intensity across zonal systems or administrative divisions used to collect migration data. A higher value of \\(k\\) indicates a greater intensity of migration within a set of regions. The migest package offers the index_intensity() function, which facilitates the calculation of migration intensity measures. This function takes a migration and population totals as inputs, alongside a value for the number of regions n, and calculates both intensity measures discussed above. library(migest) index_intensity(mig_total = 25, pop_total = 52, n = 17) ## # A tibble: 2 × 2 ## measure value ## &lt;chr&gt; &lt;dbl&gt; ## 1 cmp 48.1 ## 2 courgeau_k 8.48 4.2 Migration distance When comparing migration patterns across different regions, it is important to consider the variations in the intensity of movement across space. Migration is a spatial activity that involves movements between specific locations, and different regions may exhibit varying levels of migration intensity. To capture the effects of distance within a migration system, several measures have been developed. Measuring the distance between regions is not a straightforward task. Ideally, we would want to measure the typical distance that migrants travel. One commonly used approximation is the straight-line distance between the population-weighted centroids of each region. This approach provides a reasonable estimate of average distances moved along a migration corridor, taking into account the spatial distribution of population within each region. The costs faced by migrants may not be accurately represented by the inter-centroid distance alone. There are several factors that can complicate distance measurements. For example, regions located near borders may have centroids that exaggerate the actual distance between them. Regions can vary significantly in shape and size, making it challenging to capture the true distance between them. Additionally, features such as indented coastlines can create cultural and travel cost differences, impacting migration patterns. 4.2.1 Creating distance matrices in R In R, there are various functions available to calculate distance matrices, which are can then be used when analyzing migration patterns. These functions typically require a set of longitude and latitude coordinates to compute the distances between locations accurately. While some national statistics offices may provide these centroids, in many cases such data is not readily available. In such situations, researchers can turn to alternative sources for population-weighted centroid estimates based on gridded population estimates. The POPGRID Data Collaborative brings together multiple research groups that publish estimates of past and future population gridded datasets. These estimates can be used to derive population-weighted centroids and facilitate the calculation of distance matrices for migration analysis. Below we demonstrate how to download the population centroids from the WorldPop, one of the research groups covered by POPGRID. They handily provide CSV files for population centriods for all first-level subregions based on the global population gridded estimates in five-year intervals between 2000 and 2020 ((Edwards2021?)). We can read in the data in the 2020 CSV file (the fifth file in the zip folder) using the archive_read function in R to download the zip folder from the WorldPop website and temporarily unzip the file for reading into R. library(tidyverse) library(archive) # read in data pw &lt;- archive_read( archive = &quot;https://data.worldpop.org/GIS/Population_Weighted_Density/Unconstrained_Subnational/100m/PWD_100m_sub_national_CSV.zip&quot;, file = 5 ) %&gt;% read_csv() # view pw ## # A tibble: 3,521 × 25 ## year ISO ISO_No Country_N Adm_N GID_1 HASC PWC_Lat PWC_Lon Pop Density ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 2020 RUS 643 Russia Adyg… RUS.… RU.AD 44.8 39.8 5.13e5 66.4 ## 2 2020 RUS 643 Russia Altay RUS.… RU.AL 52.8 83.0 2.28e6 13.9 ## 3 2020 RUS 643 Russia Amur RUS.… RU.AM 51.2 128. 7.75e5 2.2 ## 4 2020 RUS 643 Russia Arkh… RUS.… RU.AR 63.4 41.8 1.10e6 2.8 ## 5 2020 RUS 643 Russia Astr… RUS.… RU.AS 46.6 47.8 1.04e6 23.5 ## 6 2020 RUS 643 Russia Bash… RUS.… RU.BK 54.4 55.9 4.17e6 29.2 ## 7 2020 RUS 643 Russia Belg… RUS.… RU.BL 50.8 37.2 1.63e6 57.7 ## 8 2020 RUS 643 Russia Brya… RUS.… RU.BR 53.0 33.7 1.20e6 35.3 ## 9 2020 RUS 643 Russia Bury… RUS.… RU.BU 52.0 108. 9.96e5 3 ## 10 2020 RUS 643 Russia Chec… RUS.… RU.CN 43.3 45.8 1.49e6 99 ## # … with 3,511 more rows, and 14 more variables: Area &lt;dbl&gt;, PWD_A &lt;dbl&gt;, ## # PWD_G &lt;dbl&gt;, PWD_M &lt;dbl&gt;, PWD_D1 &lt;dbl&gt;, PWD_D2 &lt;dbl&gt;, PWD_D3 &lt;dbl&gt;, ## # PWD_D4 &lt;dbl&gt;, PWD_D5 &lt;dbl&gt;, PWD_D6 &lt;dbl&gt;, PWD_D7 &lt;dbl&gt;, PWD_D8 &lt;dbl&gt;, ## # PWD_D9 &lt;dbl&gt;, PWD_D10 &lt;dbl&gt; We will use South Korea to demonstrate how calcaulte a populated weighted distance matrix for regions in a particular country kor_pw &lt;- pw %&gt;% filter(ISO == &quot;KOR&quot;) %&gt;% select(Adm_N, PWC_Lat, PWC_Lon, Pop) kor_pw ## # A tibble: 17 × 4 ## Adm_N PWC_Lat PWC_Lon Pop ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Busan 35.2 129. 2925666 ## 2 Chungcheongbuk-do 36.7 128. 1629527 ## 3 Chungcheongnam-do 36.7 127. 2049544 ## 4 Daegu 35.8 129. 2098338 ## 5 Daejeon 36.3 127. 1595088 ## 6 Gangwon-do 37.7 128. 1446914 ## 7 Gwangju 35.2 127. 1396761 ## 8 Gyeonggi-do 37.4 127. 15014585 ## 9 Gyeongsangbuk-do 36.1 129. 2805942 ## 10 Gyeongsangnam-do 35.2 129. 3444121 ## 11 Incheon 37.4 127. 2964572 ## 12 Jeju 33.4 127. 564353 ## 13 Jeollabuk-do 35.8 127. 1641019 ## 14 Jeollanam-do 34.9 127. 1703339 ## 15 Sejong 36.5 127. 61443 ## 16 Seoul 37.5 127. 8889778 ## 17 Ulsan 35.5 129. 1038185 The calculation of distances between centroids can calcualted using the distm() function from the geosphere package. By providing the longitude and latitude coordinates of the centroids, the function can estimate the great circle distance between them in meters. library(geosphere) kor_dist_pw &lt;- kor_pw %&gt;% select(PWC_Lon, PWC_Lat) %&gt;% distm() To enhance the usability of the distance matrix, you can add the names of the origin and destination regions to the rows and columns of the matrix using the dimnames() function. Additionally, the distances can be divided by 1000 to convert them from meters to kilometers. These manipulations allow you to easily combine the distance matrix with migration data or perform further analyses and interpolate the results. dimnames(kor_dist_pw) &lt;- list(orig = kor_pw$Adm_N, dest = kor_pw$Adm_N) kor_dist_pw &lt;- round(kor_dist_pw/1000) kor_dist_pw ## dest ## orig Busan Chungcheongbuk-do Chungcheongnam-do Daegu Daejeon ## Busan 0 216 255 88 201 ## Chungcheongbuk-do 216 0 58 130 45 ## Chungcheongnam-do 255 58 0 174 54 ## Daegu 88 130 174 0 122 ## Daejeon 201 45 54 122 0 ## Gangwon-do 286 122 159 203 166 ## Gwangju 202 184 170 175 139 ## Gyeonggi-do 312 96 83 225 125 ## Gyeongsangbuk-do 107 125 176 32 128 ## Gyeongsangnam-do 43 190 222 72 168 ## Incheon 328 111 85 242 134 ## Jeju 306 381 368 333 337 ## Jeollabuk-do 201 111 96 143 66 ## Jeollanam-do 190 205 197 177 162 ## Sejong 222 37 34 141 22 ## Seoul 324 108 95 236 138 ## Ulsan 47 203 250 76 198 ## dest ## orig Gangwon-do Gwangju Gyeonggi-do Gyeongsangbuk-do ## Busan 286 202 312 107 ## Chungcheongbuk-do 122 184 96 125 ## Chungcheongnam-do 159 170 83 176 ## Daegu 203 175 225 32 ## Daejeon 166 139 125 128 ## Gangwon-do 0 305 114 179 ## Gwangju 305 0 252 202 ## Gyeonggi-do 114 252 0 215 ## Gyeongsangbuk-do 179 202 215 0 ## Gyeongsangnam-do 275 159 285 101 ## Incheon 137 253 24 234 ## Jeju 500 199 451 365 ## Jeollabuk-do 232 75 178 161 ## Jeollanam-do 325 31 279 207 ## Sejong 155 155 104 143 ## Seoul 113 265 13 226 ## Ulsan 255 229 296 81 ## dest ## orig Gyeongsangnam-do Incheon Jeju Jeollabuk-do Jeollanam-do ## Busan 43 328 306 201 190 ## Chungcheongbuk-do 190 111 381 111 205 ## Chungcheongnam-do 222 85 368 96 197 ## Daegu 72 242 333 143 177 ## Daejeon 168 134 337 66 162 ## Gangwon-do 275 137 500 232 325 ## Gwangju 159 253 199 75 31 ## Gyeonggi-do 285 24 451 178 279 ## Gyeongsangbuk-do 101 234 365 161 207 ## Gyeongsangnam-do 0 299 277 160 148 ## Incheon 299 0 450 180 281 ## Jeju 277 450 0 275 176 ## Jeollabuk-do 160 180 275 0 101 ## Jeollanam-do 148 281 176 101 0 ## Sejong 190 112 353 79 179 ## Seoul 298 25 464 191 292 ## Ulsan 76 314 351 212 222 ## dest ## orig Sejong Seoul Ulsan ## Busan 222 324 47 ## Chungcheongbuk-do 37 108 203 ## Chungcheongnam-do 34 95 250 ## Daegu 141 236 76 ## Daejeon 22 138 198 ## Gangwon-do 155 113 255 ## Gwangju 155 265 229 ## Gyeonggi-do 104 13 296 ## Gyeongsangbuk-do 143 226 81 ## Gyeongsangnam-do 190 298 76 ## Incheon 112 25 314 ## Jeju 353 464 351 ## Jeollabuk-do 79 191 212 ## Jeollanam-do 179 292 222 ## Sejong 0 117 216 ## Seoul 117 0 307 ## Ulsan 216 307 0 4.2.2 Migration Distance Measures To capture the average migration distance and account for the skewed distribution of distances, various methods can be employed. One approach is to calculate the weighted average of migration counts, where the distances between regions serve as the weights. This provides a summary measure of the average migration distance, taking into account the varying distances between origin and destination pairs. (Bell2002?) suggests that the median average distance is preferable to the mean average distance due to the negatively skewed distribution of distances. This skewness reflects the distance decay effect, which consistently influences migration patterns. Comparing the median and mean average distances can provide insights into the degree of skewness in the distribution. To address the skewness and model the relationship between migration counts and distances, a more comprehensive method involves fitting a predictive model. Different models can be utilized, often incorporating a log-transformed distance term and categorical control variables for the origin and destination regions. For example, a Poisson log-linear model can be employed, where the logarithm of the migration count (\\(m_{ij}\\)) is related to the origin, destination, and log-distance as follows: \\[ \\log(m_{ij}) = \\beta_0 + \\beta_{1i} \\texttt{origin} + \\beta_{2j} \\texttt{destination} + \\beta_{3} \\log(\\texttt{distance}) \\] The parameter of interest in this equation is the distance decay parameter (\\(\\beta_3\\)), which indicates the impact of distance on migration. The distance decay parameter is typically negative, implying that an increase in distance leads to a decrease in predicted migration. The set of parameters \\(\\beta_{1i}\\) and \\(\\beta_{2j}\\) represent the push and pull factors specific to each region, capturing the factors influencing migration behavior. 4.2.3 Migration Distance Measures in R The migest package in R provides the index_distance() function, which allows you to calculate three summary distance measures based on a set of migration flows and corresponding distance values between each origin and destination. To use the function, you can provide the origin-destination migration flows as either a matrix or a data frame. If using a data frame, the column names are expected to be orig, dest, and flow. However, you have the flexibility to specify different column names using the orig_col, dest_col, and flow_col arguments. Similarly, the distance values can be provided as a matrix or a data frame. The column names in the distance data are assumed to be orig, dest, and dist. Just like with migration flows, you can customize the column names using the appropriate arguments. It is important to note that the origin and destination names in both the migration data and the distance data must match for accurate calculations. In cases where within-region migration moves are present in the data, the index_distance() function will automatically exclude them from the distance calculations. To demonstrate we will use migration data on internal migration between first-level administrative districts in South Korea provide in the korea_reg data frame in the migest. The data covers migration flows between 2012 and 2020 and was published by the Korean Statistical Information Service (KOSIS) at https://kosis.kr/eng. # 2020 migration data kor_mig_2020 &lt;- korea_reg %&gt;% filter(year == 2020) # check no differences in names used in migration and distance data sets symdiff(x = unique(kor_mig_2020$orig), y = kor_pw$Adm_N) ## character(0) index_distance(m = kor_mig_2020, d = kor_dist_pw) ## # A tibble: 3 × 2 ## measure value ## &lt;chr&gt; &lt;dbl&gt; ## 1 mean 105. ## 2 median 68.7 ## 3 decay -0.852 4.3 Migration connectivity The size of migration flows between different migration corridors is influenced by various factors beyond population sizes and distances. These flows also reflect the strength of historical, cultural, social, and economic ties between regions. For example, regions with stronger connections may experience higher migration flows due to shared history, language, or economic opportunities. (Bell2002?) note a fragmentation in the literature on the measurement of connections within a migration system, leading to the use of different terms such as spatial connectivity, spatial concentration, spatial inequality, and spatial focusing, among others. These terms highlight the diverse aspects of migration connections and the different perspectives from which they have be studied. To explore and analyze migration connectivity, there are numerous indices available. The migration.indices package, for instance, provides a range of indices that capture different dimensions of migration connectivity. The various connectivity measures can be broadly categorized into five groups: connectivity, inequity, Gini coefficients, spatial focusing, and coefficient of variation. These measures capture different aspects of the overall concentration of migration flows in a system, whilst two of the measures also offer extended perspectives on the concentration in-migration and out-migration flow totals. Connectivity measures assess the number of connections between regions. Inequity measures examine the distribution of migration flows across regions, in comparisons to expected migration flows under different assumptions. Gini coefficients, commonly used in economic inequality analysis, can also be applied to migration data to measure the concentration or dispersion of migration flows among regions. Spatial focusing measures identify the extent to which migration is concentrated or dispersed, indicating the level of spatial clustering or scattering of migrants across regions. Coefficient of variation measures the variability or diversity of migration flows across regions, providing insights into the heterogeneity of migration patterns. The index_connectivity() function in the migest package offers 11 different measures that capture various aspects of migration connectivity from these five groups. To calculate the measures, a user can provide a matrix or data frame containing the migration flows as input to the function. If using a data frame, the function assumes that the flows are specified in a column with the name “flow.” However, if your data frame uses a different column name for the flows, you can specify it using the “flow_col” argument. index_connectivity(m = kor_mig_2020) ## # A tibble: 11 × 2 ## measure value ## &lt;chr&gt; &lt;dbl&gt; ## 1 connectivity 1 ## 2 inequality_equal 0.541 ## 3 inequality_sim 0.281 ## 4 gini_total 0.709 ## 5 gini_orig_standardized 0.0493 ## 6 gini_dest_standardized 0.0517 ## 7 mwg_orig 0.0370 ## 8 mwg_dest 0.0389 ## 9 mwg_mean 0.0379 ## 10 cv 17.9 ## 11 acv 3.43 In the following subsection we discuss in more detail each of these measures in more detail 4.3.1 Connectivity The simplest connectivity (connectivity in the output above) evaluates the proportion of non-zero migration flows, excluding within-region flows. This measure is particularly useful when dealing with regions where populations are relatively smaller, which is more common when there are many administrative units. For the South Korea data used above, all migration corridors had non-zero migration flows during 2020 4.3.2 Inequality The inequality measures discussed by Bell (2002) are based on the distribution of observed flows compared to the expected distribution. The inequality_equal measure quantifies the distance between the observed flows and an expected distribution where all flows are equal. The inequality_sim measure quantifies the distance between the observed flows and an expected distribution derived from a spatial interaction model, such as a Poisson regression model for an independence fit. \\[ \\widehat{\\log(m_{ij})} = \\beta_0 + \\beta_{1i} \\texttt{origin} + \\beta_{2j} \\texttt{destination} \\] Both inequality measures range from 0 to 1, where a value of 0 indicates that the observed flows match the expected values, suggesting some form of equality, while a value of 1 represents the maximum distance between the observed flows and the expected flows, indicating maximum inequality in the distribution of migration flows. 4.3.3 Gini measures The Gini migration measures provide insights into the spatial focusing of a migration system, assessing the extent to which migration flows are concentrated in specific corridors compared to others. They are calculated by comparing each flow in the migration matrix with every other flow to determine the degree of spatial focusing. The gini_total measure quantifies the overall spatial focusing in the migration flows. A value of zero indicates an equal distribution of flows across all corridors, indicating no spatial focusing. On the other hand, a value of 1 indicates maximum spatial focusing, where migration is concentrated in a single corridor. In addition to the gini_total measure, the gini_orig_standardized and gini_dest_standardized values provide insights into the spatial focusing from the perspectives of origin and destination regions, respectively. These measures compare the outflows from each origin region or the inflows to each destination region, respectively, to assess the spatial concentration of the migration patterns. The standardized values ensure that the range of these measures is between 0 and 1, with zero indicating no spatial focusing. 4.3.4 Spatial Focusing The migration weighted Gini indexes specifically mwg_orig and mwg_dest, offer measures of focusing for the total in-migration and out-migration, respectively. , Also proposed by (Bell2002?), these indexes assess the degree to which migration flows are concentrated in specific origins or destinations. A value of zero indicates no spatial focusing, while a value of 1 suggests that all migration flows pass through a single origin or destination. Additionally, the mwg_mean measure provides a system-wide measure of focusing for all migration totals. It is calculated as a simple average of mwg_orig and mwg_dest. Similar to the other Gini measures, the mwg_mean value ranges between zero and 1, with zero indicating no spatial focusing and 1 indicating a high concentration of migration in a single origin or destination. 4.3.5 Coefficient of Variation The coefficient of variation (cv in the output from the index_connectivity() function above), as proposed by (Rogers1998?), is a measure provided by the function that compares the mean of migration flows to the standard deviation of those flows. Unlike some of the previous measures, the coefficient of variation is not limited to a range of 0 to 1. It provides a quantitative measure of the variability in migration flows, where a higher coefficient of variation indicates greater dispersion or inequality in the flows. In addition to the coefficient of variation, the aggregated system-wide coefficient of variation (Rogers1998?) calculates a similar measure of variation but based on the aggregate coefficient of variations of in-migration and out-migration totals. It takes into account the means and standard deviations of the total in-migration and out-migration flows. Similar to the cv measure, the acv (in the output from the index_connectivity() function above) is not restricted to a range of 0 to 1. It is particularly useful for making comparisons across different time periods or countries, as a rising coefficient of variation would indicate increasing inequality in migration flows or flow totals. 4.4 Migration impact Measures fro the impact of migration assesses the degree to which migration contributes to the transformation of human settlement patterns. In many regions around the world, migration has become or is becoming the predominant mechanism driving population redistribution. Descriptive studies often concentrate on examining net migration counts at the regional level, which reveal the direction and magnitude of population changes. However, as noted before, changes in migration volumes and may not always be revealed in net migration counts. Additional measures exist to provide a more comprehensive summary of the overall effect of migration in redistributing populations across the entire system of regions. These measures take into account not only the net migration figures but also the gross migration flows between regions. By considering the complete migration picture, these measures offer insights into the broader impact of migration on population redistribution. 4.4.1 Migration effectiveness index The migration effectiveness index (MEI), introduced by (Shryock1976?), evaluates the asymmetry or equilibrium in a migration network by comparing the sum of net migration to the migration turnover. The MEI is calculated by taking the absolute sum of net migration and dividing it by the sum of migration turnover, multiplied by 100. \\[ \\texttt{MEI} = 100 \\frac{\\sum_{i} | \\texttt{net} |}{\\sum_{i} \\texttt{turnover}_i} = 100 \\frac{\\sum_{i} | m_{+i} - m_{i+}|}{\\sum_{i} m_{+i} + m_{i+}} \\] The MEI ranges between 0 and 100. Higher values of the MEI indicate that migration is an efficient mechanism for population redistribution, as reflected by large net migration totals relative to the overall turnover. In other words, a higher MEI suggests that migration plays a significant role in reshaping the population distribution within the network. Conversely, values closer to zero are generated from more balanced migration systems with less pronounced population redistribution. A lower MEI indicates a relatively equitable distribution of migration flows, where the net migration values are smaller in relation to the turnover. 4.4.2 Aggregate net migration rate The aggregate net migration rate (ANMR), proposed by (Bell2002?), captures the overall effect of migration on population settlement patterns. It is derived from the migration net totals and the populations of regions within a country. The ANMR replaces the denominator of the MEI formula with the population of each region, denoted as \\(P_i\\). \\[ \\texttt{ANMR} = 100 \\frac{1}{2} \\frac{\\sum_{i} |\\texttt{net}_i|}{\\sum_{i} P_i} = 100 \\frac{1}{2} \\frac{\\sum_{i} | m_{+i} - m_{i+} |}{\\sum_{i} P_i} \\] The ANMR represents the net shift of population between regions per 100 residents in the country. Unlike the MEI, which uses migration turnover in the denominator, the ANMR utilizes the population of each region. This allows for a measurement of the net migration effect relative to the size of the population in each region. The ANMR has no upper limit, as it depends on the net migration values and the population sizes of the regions. A higher ANMR indicates a larger net shift of population between regions, relative to the overall population size in the country. It reflects the magnitude of population redistribution resulting from migration. Additionally, the ANMR can be seen as the product of the migration connectivity index (CMI) and the migration effectiveness index (MEI). It combines the measures of connectivity and effectiveness to provide an overall assessment of the impact of migration on population settlement patterns. 4.4.3 Preference and velocity The manual by the (UnitedNations1983?) introduces two other impact measures for migration, although these measures have become less commonly used in recent years. The preference index is derived from an expected model of migration interactions based on population shares and the overall level of migration. It compares the observed migration flows (\\(m_{ij}\\)) to an expected model where migration rates in all populations are the same. \\[ \\texttt{preference} = \\sum_{ij}{\\frac{m_{ij}}{m_{++} \\frac{p_{i}}{p_+}\\frac{p_{j}}{p_+}}} \\] where \\(m_{++}\\) is the total migration flow, \\(p_{+}\\) is the sum of populations in each region, and \\(p_i\\) and \\(p_j\\) are the population sizes of the origin and destination regions, respectively. The preference index measures the extent to which the observed flows deviate from the expected flows based on population shares and overall migration levels. There is no upper limit to the preference index. The velocity index, on the other hand, is based on a migration velocity measure (\\(\\frac{m_{ij}}{p_{i} p_{j}}\\)) multiplied by the total population and summed over all migration flows. It compares the observed flows to an expected model where flow sizes are determined solely by the population sizes of the origin and destination regions. \\[ \\texttt{velocity} = \\sum_{ij}{\\frac{m_{ij}}{p_{i} p_{j}}{p_+}} \\] Similar to the preference index, the velocity index has no upper limit. Both the preference index and the velocity index provide measures of the deviation of observed migration flows from the expected patterns based on population sizes and overall migration levels. They offer alternative perspectives on the impact of migration on population redistribution, focusing on the relative significance of observed flows compared to expectations based on population factors alone. 4.4.4 Migration Impact Measures in R The index_impact() function in the migest package allows for the calculation of all four impact measures: preference index, velocity index, migration effectiveness index (MEI), and aggregate net migration rate (ANMR). This function requires a set of migration flows and population sizes in each region. As with the previous index functions in the migest package, the migration flows can be provided as a matrix or a data frame. The function assumes that the column names for the regions and population values provided to the p argument are region and pop, respectively, in a data frame. If your data frame has different column names, you can specify them using the reg_col and pop_col parameters. In the code below we use the population estimates from the WorldPop group provided in the Pop column of the kor_pw ojbect created earlier. index_impact(m = kor_mig_2020, p = kor_pw, pop_col = &quot;Pop&quot;, reg_col = &quot;Adm_N&quot;) ## # A tibble: 4 × 2 ## measure value ## &lt;chr&gt; &lt;dbl&gt; ## 1 effectivness 7.67 ## 2 anmr 0.379 ## 3 preference 916. ## 4 velocity 45.3 4.5 Applying index functions multiple times Some of the summary measures discussed above are meaningless on their own, as they have no relative scale and have been calculated in isolation. However, the index functions can be applied to compare migration systems across different areas or time periods relatively easily using R, enabling comparative analyses. To apply the index functions multiple times, you can loop over the countries or time periods of interest and apply the functions within the loop. Alternatively, you can use vectorized operations or apply functions from the dplyr or purrr packages to handle multiple countries or time periods efficiently. To demonstrate the application of the index functions in the migest package, we can use the korea_reg data of internal migration flows between 2012 and 2020 in South Korea. First we use the group_nest() function from the dplyr package which transforms the data frame into a grouped data frame based on the year column, which is a necessary step for applying the index functions. Once the data is grouped, we can then apply the index_connectivity() function to each row using the map() function from the purrr package. This will calculate the connectivity measures for each year in the korea_reg data set. We may set long = FALSE within the index_connectivity() function to allow for separate columns for each measure. These can be viewed over time using the unnest() function in the tidyr package d &lt;- korea_reg %&gt;% filter(orig != dest) %&gt;% group_nest(year, .key = &quot;mig_data&quot;) %&gt;% mutate(connectivity = map(.x = mig_data, .f = ~index_connectivity(.x, long = FALSE))) d ## # A tibble: 9 × 3 ## year mig_data connectivity ## &lt;int&gt; &lt;list&lt;tibble[,3]&gt;&gt; &lt;list&gt; ## 1 2012 [272 × 3] &lt;tibble [1 × 11]&gt; ## 2 2013 [272 × 3] &lt;tibble [1 × 11]&gt; ## 3 2014 [272 × 3] &lt;tibble [1 × 11]&gt; ## 4 2015 [272 × 3] &lt;tibble [1 × 11]&gt; ## 5 2016 [272 × 3] &lt;tibble [1 × 11]&gt; ## 6 2017 [272 × 3] &lt;tibble [1 × 11]&gt; ## 7 2018 [272 × 3] &lt;tibble [1 × 11]&gt; ## 8 2019 [272 × 3] &lt;tibble [1 × 11]&gt; ## 9 2020 [272 × 3] &lt;tibble [1 × 11]&gt; d %&gt;% unnest(connectivity) ## # A tibble: 9 × 13 ## year mig_data conne…¹ inequ…² inequ…³ gini_…⁴ gini_…⁵ gini_…⁶ mwg_o…⁷ ## &lt;int&gt; &lt;list&lt;tibble[,3&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 2012 [272 × 3] 1 0.554 0.266 0.718 0.0500 0.0498 0.0380 ## 2 2013 [272 × 3] 1 0.552 0.270 0.717 0.0501 0.0499 0.0381 ## 3 2014 [272 × 3] 1 0.542 0.282 0.707 0.0507 0.0495 0.0380 ## 4 2015 [272 × 3] 1 0.537 0.284 0.703 0.0509 0.0496 0.0378 ## 5 2016 [272 × 3] 1 0.541 0.277 0.707 0.0505 0.0502 0.0376 ## 6 2017 [272 × 3] 1 0.538 0.285 0.703 0.0502 0.0506 0.0374 ## 7 2018 [272 × 3] 1 0.541 0.281 0.707 0.0497 0.0511 0.0370 ## 8 2019 [272 × 3] 1 0.537 0.280 0.703 0.0493 0.0514 0.0366 ## 9 2020 [272 × 3] 1 0.541 0.281 0.709 0.0493 0.0517 0.0370 ## # … with 4 more variables: mwg_dest &lt;dbl&gt;, mwg_mean &lt;dbl&gt;, cv &lt;dbl&gt;, acv &lt;dbl&gt;, ## # and abbreviated variable names ¹​connectivity, ²​inequality_equal, ## # ³​inequality_sim, ⁴​gini_total, ⁵​gini_orig_standardized, ## # ⁶​gini_dest_standardized, ⁷​mwg_orig This approach allows for easy comparison and analysis of migration systems between different areas or time periods. For example, we can see that connectivity measures such as the inequality_equal and gini_total showed a decreases after initial higher values during 2012 and 2013 in the proceeding seven years from 2014 to 2020. We can use similar code to calculate the distance indices d &lt;- d %&gt;% mutate(distance = map(.x = mig_data, .f = ~index_distance(m = .x, d = kor_dist_pw, long = FALSE))) d %&gt;% select(year, distance) %&gt;% unnest(distance) ## # A tibble: 9 × 4 ## year mean median decay ## &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 2012 108. 76 -0.784 ## 2 2013 107. 76 -0.795 ## 3 2014 108. 76 -0.816 ## 4 2015 108. 76 -0.828 ## 5 2016 107. 76 -0.820 ## 6 2017 108. 75.8 -0.839 ## 7 2018 107. 74.8 -0.839 ## 8 2019 107. 75.8 -0.836 ## 9 2020 105. 68.7 -0.852 The measures illustrate a decline in the mean and median distances over the nine years, whilst the distance decay parameter increases - again implying declining shorter migration distances. The impact and intensity measures require additional data on populatino sizes, which are provided in the korea_pop data frame in the migest package. These can be added to the data frame of the index calcaulations once nested # add population data d &lt;- korea_pop %&gt;% group_nest(year, .key = &quot;pop_data&quot;) %&gt;% right_join(d, by = &quot;year&quot;) d ## # A tibble: 9 × 5 ## year pop_data mig_data connectivity distance ## &lt;int&gt; &lt;list&lt;tibble[,2]&gt;&gt; &lt;list&lt;tibble[,3]&gt;&gt; &lt;list&gt; &lt;list&gt; ## 1 2012 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 2 2013 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 3 2014 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 4 2015 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 5 2016 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 6 2017 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 7 2018 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 8 2019 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; ## 9 2020 [17 × 2] [272 × 3] &lt;tibble [1 × 11]&gt; &lt;tibble [1 × 3]&gt; Two data sets in each year can be passed to the index_impact() function using the map2() function in the purrr package d &lt;- d %&gt;% mutate(impact = map2(.x = mig_data, .y = pop_data, .f = ~index_impact(m = .x, p = .y, pop_col = &quot;population&quot;, long = FALSE))) The intensity measures require only the migration and population totals in each year. These can be calculated by summing the appropriate columns in each data frame and passing the totals to the index_intensity() function # calculate migration and population totals for intensity measure d &lt;- d %&gt;% mutate(mig_total = map_dbl(.x = mig_data, .f = ~sum(.x$flow)), pop_total = map_dbl(.x = pop_data, .f = ~sum(.x$population)), intensity = map2(.x = mig_total, .y = pop_total, .f = ~index_intensity(mig_total = .x, pop_total = .y, n = 17, long = FALSE))) d %&gt;% select(year, contains(&quot;total&quot;), intensity) %&gt;% unnest(intensity) ## # A tibble: 9 × 5 ## year mig_total pop_total cmp courgeau_k ## &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 2012 2512740 50948272 4.93 0.870 ## 2 2013 2423429 51141463 4.74 0.836 ## 3 2014 2507796 51327916 4.89 0.862 ## 4 2015 2551424 51529338 4.95 0.874 ## 5 2016 2453342 51696216 4.75 0.838 ## 6 2017 2410930 51778544 4.66 0.822 ## 7 2018 2429184 51826059 4.69 0.827 ## 8 2019 2384948 51849861 4.60 0.812 ## 9 2020 2534114 51829023 4.89 0.863 In the case of South Korea, there does not appear to be a general trend for either intensity measure over the nine year period. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
